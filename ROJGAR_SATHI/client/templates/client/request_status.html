{% extends 'base/base.html' %}
{% block content %}

<div class="container mt-4"> <h2 class="text-primary mb-4">My Work Requests</h2> <!-- Filter Buttons --> <div class="mb-4 text-center"> <a href="?status=all" class="btn btn-outline-primary {% if filter_by == 'all' %}active{% endif %}">All</a> <a href="?status=pending" class="btn btn-outline-warning {% if filter_by == 'pending' %}active{% endif %}">Pending</a> <a href="?status=accepted" class="btn btn-outline-success {% if filter_by == 'accepted' %}active{% endif %}">Accepted</a> <a href="?status=rejected" class="btn btn-outline-danger {% if filter_by == 'rejected' %}active{% endif %}">Rejected</a> </div>
{% if requests %}
<table class="table table-bordered table-hover">
<thead class="table-light">
<tr>
<th>Hunarbaaz</th>
<th>Description</th>
<th>Location</th>
<th>Date</th>
<th>Status</th>
 <th>Actions</th>

</tr>
</thead>
<tbody>
{% for request in requests %}
<tr>
<td>{{ request.hunarbaaz.full_name }}</td>
<td>{{ request.job_description }}</td>
<td>{{ request.location }}</td>
<td>{{ request.scheduled_date }}</td>
<td>
{% if request.is_accepted == True %}
<span class="badge bg-success">Accepted</span>
{% elif request.is_accepted == False %}
<span class="badge bg-danger">Rejected</span>
{% else %}
<span class="badge bg-warning text-dark">Pending</span>
{% endif %}
 {% if request.is_accepted %}
  {% if not request.is_completed %}
    <a href="{% url 'client:mark_completed' request.id %}" class="btn btn-sm btn-outline-success">Mark as Completed</a>
  {% else %}
    <span class="badge bg-secondary">Completed</span>
  {% endif %}
{% endif %}
</td>
<td>
  {% if request.is_accepted == None %}
    <!-- Only for pending requests -->
    <div class="d-flex gap-2">
      <form method="post" action="{% url 'client:cancel_request' request.id %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-sm btn-outline-danger">Cancel</button>
      </form>
      <a href="{% url 'client:reschedule_request' request.id %}" class="btn btn-sm btn-outline-secondary">Reschedule</a>
    </div>
  {% else %}
    <span class="text-muted">No actions</span>
  {% endif %}
</td>
 </tr>
{% endfor %}
</tbody>
</table>
{% else %}
<p class="text-muted text-center">No {{ filter_by }} requests found.</p>
{% endif %}

</div> {% endblock %}